<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles/productCatalog-module.css" />
    <title>Product Catalog</title>
  </head>

  <body>
    <div class="container" id="product-container">
      <img id="logo" alt="cat logo"/></a>
      <div>
        <h1 id="title"></h1>
        <hr class="line" />
        <p id="desc">
          Demos are a many and many are boring. Demo Cat is here to change that.
          Thank you all my AI cat buddies ðŸ˜» and ChatGPT! Couldnâ€™t have done it
          without you!
        </p>
        <div id="products"></div>
        <div id="pagination"></div>
      </div>
      <footer></footer>
    </div>

    <script>
      // click event for every card
      // document.addEventListener("DOMContentLoaded", function () {
      //   const clickableCards = document.querySelectorAll(".inner-card");

      //   clickableCards.forEach(function (card) {
      //     card.addEventListener("click", function () {
      //       window.location.href = "./productDetail.html";
      //     });
      //   });
      // });

      // Load the global items
      fetch(
        "https://www.includecore.com/api/projects/4854/globals/7319-globals",
        {
          method: "GET",
          headers: {
            Accept: "application/json",
          },
        }
      )
        .then((response) => (response.ok ? response.json() : Promise.reject()))
        .then((data) => {
          console.log(data);
          document.getElementById("logo").src = data.logo;
          document.querySelector("footer").textContent = data.footer;
          document.getElementById("title").textContent = data.title;
        })
        .catch((error) =>
          alert("Something went wrong, please try again later.")
        );

      // Load the product lists and pagination
      fetch(
        "https://www.includecore.com/api/projects/4854/databases/7334-Products?pageSize=1&page=1",
        {
          method: "GET",
          headers: {
            Accept: "application/json",
          },
        }
      )
        .then((response) => (response.ok ? response.json() : Promise.reject()))
        .then((data) => {
          console.log(data);

          const productContainer = document.getElementById("product-container");

          // Loop through the product data and create HTML elements
          data.data.forEach((product) => {
            const productCard = document.createElement("div");
            productCard.classList.add("product-card");

            const productTitle = document.createElement("h2");
            productTitle.textContent = product.products_list.product_title;

            const productDescription = document.createElement("p");
            productDescription.innerHTML =
              product.products_list.product_description;

            const productPrice = document.createElement("p");
            productPrice.textContent =
              "Price: $" + product.products_list.product_price;

            const productImage = document.createElement("img");
            productImage.src = product.products_list.product_image;
            productImage.alt = product.products_list.product_title;

            // Append elements to the product card
            productCard.appendChild(productImage);
            productCard.appendChild(productTitle);
            productCard.appendChild(productDescription);
            productCard.appendChild(productPrice);

            // Append the product card to the container
            productContainer.appendChild(productCard);
          });

          // Pagination
          const paginationContainer = document.getElementById("pagination");

          // holds the total number of pages
          const totalPages = data.pagination.last_page;

          for (let i = 1; i <= totalPages; i++) {
            // creates an a element for each page
            const pageElement = document.createElement("a");

            pageElement.textContent = i;

            pageElement.classList.add("pagination-link", "hide-text");

            // Add an event listener to handle page changes
            pageElement.addEventListener("click", () => {
              // Reload the page with the selected page parameter
              window.location.href = `./productCatalog.html?page=${i}`;
            });

            paginationContainer.appendChild(pageElement);
          }
        })
        .catch((error) =>
          alert("Something went wrong, please try again later.")
        );
    </script>
  </body>
</html>
